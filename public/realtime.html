<!doctype html>
<html>
<head>
<meta charset="utf-8" />
<title>Sougata - Real time</title>
<meta name="csrf-token" content="{{ csrf_token() }}">
</head>
<body>
<h1>Sougata â€” Real-Time Messages</h1>


<form id="sendForm">
<input type="number" id="sender_id" placeholder="sender_id" value="1" required />
<input type="text" id="message" placeholder="Type message..." required />
<button>Send</button>
</form>


<ul id="messages"></ul>


<script src="/node_modules/pusher-js/dist/web/pusher.js"></script>
<script src="/node_modules/laravel-echo/dist/echo.iife.js"></script>
<script>
// adjust host/port if needed
const PUSHER_KEY = 'local';
const WS_HOST = window.location.hostname;


const echo = new window.Echo({
broadcaster: 'pusher',
key: PUSHER_KEY,
wsHost: WS_HOST,
wsPort: 6001,
forceTLS: false,
disableStats: true,
enabledTransports: ['ws', 'wss']
});


const messagesList = document.getElementById('messages');


echo.channel('messages')
.listen('.message.received', function(e) {
const li = document.createElement('li');
li.textContent = `[${e.message.sender_id}] ${e.message.message}`;
messagesList.appendChild(li);
});


// send via API
document.getElementById('sendForm').addEventListener('submit', async (ev) => {
ev.preventDefault();
const sender_id = document.getElementById('sender_id').value;
const message = document.getElementById('message').value;


const res = await fetch('/api/messages', {